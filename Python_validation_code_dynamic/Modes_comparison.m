clearvars
close all
clc


set(groot, 'defaultAxesTickLabelInterpreter','latex');
set(groot, 'defaultAxesFontName','latex');
set(groot, 'defaultLegendInterpreter','latex');
set(groot, 'defaultAxesFontSize',30);
set(groot, 'defaultAxesFontWeight','bold');
set(groot, 'defaultLegendLocation','northwest');

% figure(1)
% title('Nodes')
% %scatter3(nodecoord(:,1),nodecoord(:,2),nodecoord(:,3),'*b')
% scatter3(nodecoordb5s0(:,1),nodecoordb5s0(:,2),nodecoordb5s0(:,3)+phib5s0(:,2),'r')
% hold on
% scatter3(nodecoordb5s0(:,1),nodecoordb5s0(:,2),nodecoordb5s0(:,3)+phirefb5s0(:,2),'g')
% zlim([0 10])
% figure(1)
% title('Nodes')
% %scatter3(nodecoord(:,1),nodecoord(:,2),nodecoord(:,3),'*b')
% scatter3(nodecoordb5s0(:,1),nodecoordb5s0(:,2),nodecoordb5s0(:,3)+phib5s0(:,mode),'or')
% hold on
% scatter3(nodecoordb5s0(:,1),nodecoordb5s0(:,2),nodecoordb5s0(:,3)+phirefb5s0(:,mode),'*g')
%
% scatter3(nodecoordb5s0(:,1),nodecoordb5s0(:,2),nodecoordb5s0(:,3)+phinoordb5s0(:,mode),'<k')
% zlim([0 10])

%b0s0
mac0 = [0.9999860156493573  0.23663261881101333  0.009748634918837637  0.04669230917514655  0.0006778840472462754  0.010747044602475088  9.103010017510314e-07  0.0035099676552853695  0.0006404918793343914  0.0033560977855774487 ;
    0.22372127608219572  0.9997243874656185  3.178373444171052e-06  0.3091473602578768  0.011824878707491843  0.05539761059871807  0.016044793645218366  0.02336160775462674  0.0031904180743557243  0.01271092056588863 ;
    0.008860112397205055  8.441318792660542e-05  0.9999193590199674  5.258231099897707e-05  0.0005313302658449716  0.03247631111151881  0.23452510956097042  0.00858926832153816  4.3845091925615406e-05  0.00021843977059500554 ;
    0.03789302164674155  0.2810971715049979  6.327344740124514e-05  0.9986216664623118  0.02791435167817948  0.2952898517698217  0.03504161704085034  0.06393178167622365  0.008345474348767151  0.030769932677795285  ;
    0.0008506395243534902  0.02138613757369375  0.005078856753432967  0.05350647258092675  0.9619005918457766  0.01573508906480648  0.00011513605590487425  0.2529472606189553  0.15169407410785507  0.056881614534363814;
    0.008065909639132961  0.03149420020971182  0.026497439088804597  0.20754155340329308  0.10658015033561646  0.9308442753024105  0.003210320202388128  0.07625350852871099  0.20708497392372588  0.01602347978695697  ;
    4.646104342412515e-07  0.015326401645846241  0.2182908386535974  0.033828940602288374  0.00043550276015297994  0.000620364001095839  0.9995196707337052  0.0010473635612872688  0.0012160920785966524  0.0096490917186877;
    0.00324845302965049  0.022729299997766645  0.008192308837794721  0.05878273485578161  0.12138934912021689  0.19281808215615395  0.0010987749221580308  0.9777161874401253  0.0014166798542361817  0.35132641960235955  ;
    0.0006207429933870404  0.0014378549628729265  3.4057947857044985e-05  0.0031164630302872986  0.23735063038068824  0.08946648322395837  0.0008986925462227068  0.0825363397385078  0.9879229774860311  0.02300852556159407;
    0.0035589152686249293  0.010554483001868233  0.00013143238452025972  0.028712788145394942  0.027836139580829228  0.03890058317525529  0.01060209037185356  0.3747363630502935  0.00239861188527348  0.9924437346604963 ];

%b5s0
mac1 = [0.9999874521897785  0.23663381011738002  0.009854690989559883  0.04597096968881453  0.001523202053120056  0.009233331490473274  8.44267993377817e-06  0.004096883797091175  0.0003911092035647642  0.0036661834387024792;
    0.2241215805712535  0.9997494675613859  5.993006611296734e-06  0.306954320607533  0.01667437188063888  0.04401817533230324  0.017173834930913533  0.02631930308298161  0.0018074731428246356  0.012822828243530081  ;
    0.008922678703996977  0.00012394800621551993  0.9999248483983246  0.00011342519873127286  0.0028302909675495098  0.03244051704496243  0.23178839581255492  0.008475566702767286  5.383922710832567e-07  7.015011761600169e-05  ;
    0.037552598981653675  0.2809411884276521  0.00012453665218388599  0.9989898132558958  0.05617898829812075  0.24541125839235714  0.037463090325221056  0.0719136271575513  0.004069502236598333  0.03195515362185773 ;
    0.003984569113787852  0.04146550843882945  0.019293338664579954  0.1668416586679265  0.8016224859844023  0.12767462015813122  0.0002467233619884339  0.3314532488246883  0.06584043442173558  0.07315961416676861  ;
    0.004354152596780336  0.00958613996196573  0.014450656191896874  0.08405254457858763  0.32231915300079367  0.7620509963377088  0.003278681233564781  0.014244368209022425  0.28195716542140203  0.00041834865001909907  ;
    8.418649232692197e-06  0.016601703809060574  0.2152326400964367  0.03658669942033885  3.90245741705262e-05  0.000677050921457232  0.9993906484249979  0.002076492374785883  0.0016581387645933376  0.013402521065381945  ;
    0.0036195436261795533  0.023815303072622498  0.007719111746924116  0.06183008782747116  0.13864754789353445  0.16288572594512665  0.0018742801451396428  0.9927224469641309  0.00237058430184455  0.33812232960679933 ;
    0.0006176547391002198  0.001260025702975721  5.192171922226009e-05  0.0020064209713295113  0.21312533254692292  0.12316908699155109  0.0012594628723673665  0.029933800734404957  0.9970113407008485  0.016367495475671803 ;
    0.0037588293426474824  0.01040742777765785  2.7373938068704766e-05  0.02922461392972595  0.038427231230925195  0.02361131646192025  0.01424276913609458  0.367814027564835  0.01276457159235194  0.9964560632037147 ];

%b-5s0
mac2 = [0.9999841085195225  0.2367544210809319  0.009607250022525896  0.04783112033837569  0.00046266551540059993  0.011562941785364525  1.0525994084448088e-06  0.002530536233092079  0.0012231264739354585  0.003056370652609028;
    0.22337300885766817  0.9996865569986068  6.613975038552244e-07  0.31139781388090915  0.011974892707516723  0.06264655517974477  0.014915931758671445  0.01775291380443572  0.006595567109553829  0.012704301120450128  ;
    0.008774224228632619  4.442690483288673e-05  0.9999022472554523  1.2021633068528237e-05  3.962158835385669e-05  0.029932135676945037  0.2374351254491797  0.007961031619543951  0.00041800427857254375  0.0004537390049969989  ;
    0.03852934360776819  0.28108430971886195  1.7583769503140052e-05  0.997888107487601  0.01851150751407278  0.3227225372876618  0.03275626964344479  0.04680838386866336  0.019460165166381528  0.02905826951633905  ;
    0.00016674962255872947  0.014480047968024714  0.001449328131639156  0.01567936940863944  0.9937327181051336  0.0007020681722334475  0.0006010507138682431  0.2568222041611219  0.1514460170313331  0.04887099428688747 ;
    0.009511875759080694  0.045707212869067294  0.02874819690638871  0.27077932561106555  0.027554414284347316  0.9841960944261186  0.0024587657007424965  0.08016711271784506  0.19954678472504359  0.03237154460453859  ;
    2.2695227674611694e-06  0.014028197703431113  0.22135420593700647  0.031143382631341646  0.0010790868803247859  0.00046134503876266863  0.9995573124939674  0.0003364845155595289  0.0009927260194929478  0.006491629769636104;
    0.002782875727333116  0.02098618316551643  0.008685705660202865  0.052003878154913696  0.13910243820445317  0.1836923253417454  0.0004979289107369753  0.9371770566569797  8.377463884386064e-05  0.36738328448240937  ;
    0.000687974707426632  0.0019003995905799895  1.5051036716872686e-05  0.005987652603726473  0.23486088229098404  0.08770840389065618  0.0007678347609188694  0.19606851779764636  0.9532638519574151  0.026581715153352708 ;
    0.0033449408643381725  0.010854956967195559  0.000317889328151886  0.027920934192826978  0.02369901961461181  0.049113217489970426  0.0075532876264654105  0.34985557640349924  0.0032156315927834795  0.9832051447040442  ];

%b0s25
mac3 = [0.9999853666430994  0.23231984313430226  0.011403422438788054  0.045429828398201914  0.0010239413852785417  0.009767046847099304  1.3039586095913511e-05  0.0037846391922715995  0.0004664932561443898  0.003496827319118565 ; 
0.21852428262753565  0.9997112826752241  0.00011073643039827081  0.30461296649995534  0.014602241443801305  0.04438716868893089  0.020914741733114365  0.024835117045787627  0.0021360922990654894  0.012774881289071007 ; 
0.010377264067588444  0.0003179566259645052  0.9999188502640737  0.0003642241462164766  0.001798934661202019  0.03991424797226881  0.22506722955781822  0.008266270236251275  1.0250347713771979e-05  0.00010159286722296718;  
0.036623146458450564  0.27702440099149606  0.00038129546327830415  0.9987654689527418  0.043065022875442824  0.25900540166272595  0.041484833383095984  0.06996441187557419  0.005097192768668021  0.03156496073040914 ; 
0.002401202288483912  0.0325588229568043  0.014833304871165142  0.11613176451711116  0.8752497304914961  0.07409986305674533  0.00022392388949036174  0.3069443111812857  0.0989080356221961  0.06983734053315191  ;
0.005629892392607152  0.013607069389211435  0.024846528573176235  0.12026324805778983  0.24349965989253963  0.8231276548479297  0.0060003274947656934  0.028248328728990284  0.25421822149815315  0.002417620761324296;  
1.7954014369246703e-05  0.02015437504492096  0.2061528046460391  0.04170258653676238  1.0051456987913836e-06  0.0006671961201663206  0.9988857401496152  0.003055323693063623  0.0028572265415561606  0.013530342815674775;  
0.003371359284502361  0.022847704937815225  0.007651882639013386  0.06094048077300016  0.13226440662710104  0.1724449643178705  0.0026083242737056154  0.9876642675118552  0.002507928496235523  0.3459743028026691  ;
0.0005634352036555034  0.001178045094744995  3.414488336304774e-05  0.00210927031570253  0.2232579452535775  0.10509394546133208  0.0018389561987963551  0.049824384285201084  0.9944676182299269  0.02111444481345821;  
0.003617191009703053  0.010422472944684071  3.475983328600916e-05  0.029003548297896597  0.0355665798987722  0.02698221654009647  0.014670707769944944  0.37489564825617894  0.010231902698188217  0.9951797444733171 ];
%b0s-25
mac4 = [0.9999866708924315  0.2401722751219314  0.008678117182091773  0.047871250035872476  0.0005329920509917613  0.011404714074577178  6.791488418319911e-10  0.003106492565882226  0.0009123414802282705  0.00320947413714243 ; 
0.2281278872077969  0.9997336985368148  3.8325683034067975e-05  0.31302944157534957  0.01032421162479414  0.06269662337111671  0.013264700064290156  0.020709905743774154  0.004861356898023457  0.012657499838865506  ;
0.007871690987435892  1.5098246100793774e-06  0.9999172424220802  7.892450807593229e-06  0.0001335087891336718  0.02818443113313791  0.2400858011496875  0.009315595288216587  0.00015089249066874974  0.00030311081543833403;  
0.03909505274473242  0.28452948037031084  2.7938610712742265e-06  0.9984620354495679  0.01983275878716668  0.31665465711389257  0.032627788349379204  0.054713472835691834  0.013469733545319763  0.029929225147394732  ;
0.0003186818794721566  0.015030273445922209  0.002073294648389375  0.025373779902984277  0.9877610257109734  0.002568738193238371  0.0006994743822435198  0.23532367095889323  0.16800247800574447  0.04760505767002141;  
0.009375515853590172  0.04462619849745505  0.02573965227091686  0.2583718639844222  0.045925264401416935  0.9737726742795912  0.0015564196868407191  0.09738549165567141  0.1876899867764558  0.0286118603806535 ; 
6.059775280963009e-07  0.01256783795356897  0.22576579952199424  0.03076297540220261  0.0011038074818437412  0.00031072501177432075  0.9996694289284808  0.0002608749729196432  0.0006410617902174635  0.008301907987191472  ;
0.003099912743880189  0.022143847757879496  0.009256319215024691  0.05531145666863202  0.12102134754411502  0.19894466915942954  0.0005076155460729334  0.9597342070879981  0.00013712182003404176  0.35418796981548245 ; 
0.0007122666578130923  0.001833741913294336  3.118930580584316e-05  0.004648394755768339  0.2425480007139305  0.08415977500083106  0.0004518812924205064  0.12997399797439252  0.9748799738818774  0.023021930994128918;  
0.0034671638036369054  0.010697801003695741  0.00020989077361559125  0.02843902963268283  0.02335458147813907  0.04631880659685422  0.009516001842205728  0.3629585903103792  6.426401844637223e-05  0.9885562374593572 ];


% Display it.
imagesc(mac4)
colorbar('TickLabelInterpreter', 'latex');
set(gca,'XAxisLocation','top');
xticks([1 2 3 4 5 6 7 8 9 10])
yticks([1 2 3 4 5 6 7 8 9 10])
